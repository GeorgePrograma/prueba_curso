Branch2's modification